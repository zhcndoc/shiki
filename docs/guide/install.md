---
outline: deep
---

# 安装和使用

<Badges name="shiki" />

## 安装

你可以使用包管理器或[使用 CDN](#cdn-usage) 进行安装：
::: code-group

```sh [npm]
npm install -D shiki
```

```sh [yarn]
yarn add -D shiki
```

```sh [pnpm]
pnpm add -D shiki
```

```sh [bun]
bun add -D shiki
```

```sh [deno]
deno add npm:shiki
```

:::

## 集成

我们也提供了一些集成以便你使用：

- [markdown-it 插件](/packages/markdown-it)
- [Rehype 插件](/packages/rehype)
- [TypeScript Twoslash 插件](/packages/twoslash)
- [Monaco Editor 语法高亮](/packages/monaco)
- [CLI](/packages/cli)
- [常用转换器 (Transformers)](/packages/transformers)

## 使用方法

### 简写

使用 `shiki` 的最快方式是调用简写函数。它会根据你的需要加载主题和语言，并将其自动缓存到内存中。

将你的代码片段传给 `codeToHtml` 函数并指定 `lang` 和 `theme` 选项，它将返回一个带有语法高亮的 HTML 字符串，你可以将其嵌入到页面中。生成的 HTML 中，每个标签都有相应的内联样式，因此你不需要额外的 CSS 来进行样式设置。

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"41c80e9ec8bfa797907b84f3b212027022c608da65d96200c9f846bd6b17417c","data":"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"}
import { codeToHtml } from 'shiki'

const code = 'const a = 1' // 输入代码片段
const html = await codeToHtml(code, {
  lang: 'javascript',
  theme: 'vitesse-dark'
})

console.log(html) // 带有高亮显示的 HTML 字符串
```

更进一步，你还可以使用 `codeToTokens` 或 `codeToHast` 函数来获取中间数据结构，并自行渲染它们：

```ts twoslash theme:min-dark
// @twoslash-cache: {"v":1,"hash":"b815da6ae7b98fc8742ecce6129ff09de56b53a6198bbf341d9bfeceb03a3cda","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808AKAQwBsBLZuASgAIBjCGDhoB0GABUIUgNYxhiXo0GxFI0uzABzCrwhY07IXEUBhcVNny4AeQNHhAHgBCAVzBRWMKABlm212YtGF03Dy8oCXwYAFsYAD4+AF543gAFUggY9jgYRythACV4V1Y0eIAdMHYYrAhSURVJaQg5YUoQEWYGpABOKi9tNHwkAEYAJio0buCGRBAmy1brDo4wXEQABip+fG7mfhpyRF6AXwp0bA2CYjIOmno8QWFRNGWFXijY7wLkAF1/h0oBB+Ah5uMACK8bqkZgYPQAM14bzacF0CPYpBEvCgNWsDl4OV4a3gulyzygOLxwgJRJR1kJYGhxM0MAAdB0uj1EAAWABsA3kWmGSAF1BmMDm1HeCAGrKQkwWe1hhzuiAAHOdLjg8IQSOQpnQpSwOFw+IsWqjlOI1GgNNpdPpDMYzBZLdY7M6nGFPN4/AEgiFeD6Il84olFBksjk8gU4MU4KVylUanUGmJYEtUZzpty+QBmQVDEaICZTCVSi1x1byxCK3b7VXHcYAVi11CuutuBuoRqYWEyOAaGD4rH8WgA/IoQ37x4FgrwAD68ADKOH4nFY/q085gS947lgGPWUBz3Tmo1G2xAg2FJZ55dIszwY+0NfWSELSsbRwV7cwOrzHqdyGo88yMAO+hkJgfDmLAnoOHAK6aFoXhhnkM6RNE4ZssM3yKOhxRaDkdrMF6ACCYDwsuK52ihPjsEcbAAKrVEILiHqG2FBuoKHxGe3ITGKt4iogLaPs+8x4XE74bA+34qr+danH8OziHgqb1KIwAZs0ca8KcvAIpkMS8AA5HA+DsDI7BmVUVTPNiOn0sIBm8Ek0IAO7MIxulZtYjBmY4uJEAIY5wHASQVCACIQBA0XxAARt0jgAPQhfEZm6MAVS8MS46KGZ+BoDErBZblyLcYV2RgAAtFA3QyHZYCnNwHRxNMSCgEa+JCHgaAIKcpxAA="}
import { codeToTokens } from 'shiki'

const { tokens } = await codeToTokens('<div class="foo">bar</div>', {
  lang: 'html',
  theme: 'min-dark'
})
```

```ts twoslash theme:catppuccin-mocha
// @twoslash-cache: {"v":1,"hash":"c2d38cc11de83aa2f1d11651d47d604c307a1a81460c52619a8483484bbcdeb6","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808AKAQwBsBLZuASgAIBjCGDhoB0GABUIACS5pEvRoNgKRpdmADmFXhCxp2QuAoDC4qbJEB5fYeEAeAEIBXMFFYwoAGWZbnzTRgdFzcPKAl8GABbGAA+PgBeWN4ABVIIKPY4GHsAJQgINFiAHTB2KKwIUlFlSRk5ShARZmqkAE4qDy00fCQARgAGKjQWwIZEEFqLBs6NXEQhyfwW5n4ackQ2gF8KdGx5gmIyRpp6PEFhUWWRBXzCxubWxAAWACZOmG7el+HRmHGCDMQBwwPN3ksVmtjogAGw7PY4PCEEjkYZ0AEsDhcPhTeoiJTiVRodRaHR6AxGUzmPFoGwUhwhdyeHx+AJBXiMsIRaJxbgKNIZLI5O5FUrlSrVMSwaYiB4jJ4AVgVHy+/UW8rG52plgYs1BSHB/GWpFW6362121H2SKOqOo6KYWHSOGqGD4rF8mgUxUmcDgPrlLXGbQ6wM+mh6SGev1ImomHq0jRB8wAzFQjZCzYhXvCrYiJsjjmizhNGE69GRMHwzLA6XY4ABlDSaDzcmJOVxM8KRGKxAB0PR5CjbMFyME0WWJzHpAEEwBheAAfXgN4nNrzsdZsACqZSEHdCnhHOjUzdigaefT60bDqsQyuofwBg5iSbmUfTxtN0JzAF10+IeDilUojAFKdQ6rwWy8AAZukUS8AA5HA+DsAA1uwiGlKUFwiLw1yiAkvDMAA7swm7gTKaCMIhA7ogAtKQni8GBgisFUChMVAADcUGITowClLwvAJl6SH8H6/FCbwL4wAoiH8NOWBYM4/D8Bo9FRBAGZYWAWzcI0MQjEgoDop8cB2HgaAIFsWxAA=="}
import { codeToHast } from 'shiki'

const hast = await codeToHast('.text-red { color: red; }', {
  lang: 'css',
  theme: 'catppuccin-mocha'
})
```

### 高亮器用法

因为 Shiki 使用了 WASM，所以提供的[简写](#简写)函数是异步执行的，并在其内部按需加载主题和语言。在某些情况下，你可能需要同步地高亮代码，因此我们提供了 `createHighlighter` 函数来创建一个可以在后续同步使用的高亮器实例。

使用方式与 `codeToHtml` 函数几乎相同，其中，每个主题和语言都是动态导入的 ES 模块，最好显式地列出语言和主题以获得最佳性能。

```ts twoslash theme:nord
// @twoslash-cache: {"v":1,"hash":"ff200c26fbb7d2850639416fc02cdde29ba3702c46826bd9111080344df88ee3","data":"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"}
import { createHighlighter } from 'shiki'

// `createHighlighter` 是异步的，它会初始化高亮器
// 并加载指定的语言和主题。
const highlighter = await createHighlighter({
  themes: ['nord'],
  langs: ['javascript'],
})

// 然后你就可以同步地使用 `highlighter.codeToHtml`
// 并使用你指定的其中一个主题和语言。
const code = highlighter.codeToHtml('const a = 1', {
  lang: 'javascript',
  theme: 'nord'
})
```

:::info 重要注意
高亮器实例应该 **持续且唯一存在**。你或许应该在某些地方缓存它，并在整个应用程序范围内复用。避免在热函数或者循环中调用 `createHighlighter`。

如果你在 Node.js 上运行，我们建议使用 [简写](#简写)，它会为你管理高亮器并动态加载语言和主题。
:::

此外，如果你要在创建高亮器后加载主题和语言，可以使用 `loadTheme` 和 `loadLanguage` 方法。

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"8ce2944f34901319a707c331109f0ab6777c21709e2685cf9e4136e2d0985b06","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808BjCMONAAnwEsBzfAG174apROwASQwXxEBxGGDJdGAHgBCAVzBR+MKABkAhmB4bDPGBXabtuqABV8MALYwAfJRBtDpBogCsAAxUuiZo+EgAjJFUaD4WfgRSQiKegopRVIz4PoaMqYgAbAC+FOjYuIgExGSeNPR4ABRYpBA4vhgAlOwAytwA1lwAkmAiYIb86lo6ekYmZhZWNjMOTq5uAHT8EIarLjBijRvH4ftwh8t2jvvsAD7s164jWBoc9wA64Cwwn53IALrdAC8bnYAAVWs4uHAYCoiBAuFAPFQoBBGAgqvodlB2IZ2KdXPiIPinJxkjIyFY4MT+IYROwuBxGMZ2AAjGDsDQwnFwDBgbKtSBc/gYDaeby+JCFABMIQUPHCSAAnLF4jBEttdo9cCEuBlEDEQNlcvlagaABylco4PCEEjkWJ0RLMVgcbh8aTCMhiSQelJkeSKUjKKa2WbGUzmSzWaZXNbucVxSWIJX+OVhCIGw1JhK28leh0gdKVWVGnKkPIFEplagVW01Qv1RLNVrtTDdPpcQYjMYTUMrOaRxYxsN7dZbbGDhYHdhHY60kznWeXcPzKN3dhTqPPV4bno4RhcCZbix/QHsEHgyHQ2HwxHIkCo9F4LG7XHsBdDjloYmnMl+ilSCpGk6TIBkmRZdlOW5dheX5fBBQgYVRUTHw/EiQIAHZ0wVTNIlLHN1TwTUDAjac0j1EssnLSszUiS1/iyaBKhAAB6ViP2xEkzlxbQPzIqM4FxAAzelGFIGA6S4Fh3nGAB3QxGX/AR/VICctXjRoAHIiEZeAYQAWk9NAtM6WTDAUpT3RUwD1NItcLG09E4FMzxXDiJBQCdBQ4GksA8DQBBimKIA=="}
import { createHighlighter } from 'shiki'

const highlighter = await createHighlighter({ themes: [], langs: [] })
// ---cut---
// 在创建后加载主题和语言
await highlighter.loadTheme('vitesse-light')
await highlighter.loadLanguage('css')
```

自 v1.0 起，`shiki` 要求所有的主题和语言都被显式地加载。

```ts theme:slack-dark twoslash
// @twoslash-cache: {"v":1,"hash":"1ee71b9f4a7442d0f26a96184274c41dee9fe38155b246db2fc307bcbcbaa159","data":"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="}
import { createHighlighter } from 'shiki'

const highlighter = await createHighlighter({
  themes: ['slack-dark'],
  langs: ['css']
})

highlighter.codeToHtml(
  'const a = 1',
  { lang: 'javascript', theme: 'slack-dark' }
)
// @error: Throw error, `javascript` is not loaded

await highlighter.loadLanguage('javascript') // 载入语言

// 正常工作
```

如果你想一次加载所有主题和语言 (并不建议)，你可以遍历 `bundledLanguages` 和 `bundledThemes` 中的所有键。

```ts twoslash theme:poimandres
// @twoslash-cache: {"v":1,"hash":"dd8d8483513c7af7c69f023dcf019990d5e778ee8dcb9c1d2efae892eb82698e","data":"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="}
import { bundledLanguages, bundledThemes, createHighlighter } from 'shiki'

const highlighter = await createHighlighter({
  themes: Object.keys(bundledThemes),
  langs: Object.keys(bundledLanguages),
})

highlighter.codeToHtml('const a = 1', {
  lang: 'javascript',
  theme: 'poimandres'
})
```

### 细粒度捆绑

导入 `shiki` 时，所有的主题和语言都被捆绑为异步块 (async chunks)。通常情况下，如果你不使用它们，你就不必在意，因为它们不会被加载。某些情况下，如果你要控制这些捆绑包的内容，你可以使用核心 (`shiki/core`) 来组合自己的捆绑包。

查看[细粒度捆绑包](/guide/bundles#fine-grained-bundle)部分了解更多详细信息。

### 预设捆绑包

为了方便使用，我们还提供了一些预制的捆绑包，你可以在[捆绑包](/guide/bundles)部分了解更多的信息。

### 使用 CJS

为了减小包的大小，`shiki` 以仅 ESM 的形式发布。但由于 Node.js 支持在 CJS 中动态导入 ESM 模块，你仍可以在 CJS 中使用 Shiki。

例如以下 ESM 代码：

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"31cb8c24a5b8abe4997aea7d1bb33ae1612eeee20ef6f40600bdbb3b8f6a55f7","data":"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"}
// ESM
import { createHighlighter } from 'shiki'

async function main() {
  const highlighter = await createHighlighter({
    themes: ['vitesse-dark'],
    langs: ['javascript'],
  })

  const code = highlighter.codeToHtml('const a = 1', {
    theme: 'vitesse-dark',
    lang: 'javascript',
  })
}
```

可以在 CJS 中写成：

```ts twoslash
// @twoslash-cache: {"v":1,"hash":"8ac7891a4f3b0493e702f79097cb3e4f9dfcfb7e469a473745ad3383b28cb3cc","data":"N4Igdg9gJgpgziAXAbVAFwJ4AcZJACwgDcYAnEAGhDRgA808AzAVzAGM0BLCMAAgFsAhpzAAKAJSJeABVIR+nODAA8RCJygA+SiDhpBpBogBMxqgBsYYAOZp8SACxV9pazCMghIneZG5EAIxUbPgGghxkSAEArAC+FOjY/gTEkc50Hmw8erxspDCCNAASnNb4vmU0pFIAwvmFMCVlFfhVAGLhaBCkGMoAQqxQllAAMoI2zIJuFLwDYEMwUAAq+DD8MNpUegZGDkEgljZ2UQDszgZumfXFpeW3VT5+SGYgIWER5IEADPGJOHiEEjkdL0PBZMA5fC3FpVKRNO6VMgAcSsZE4bH6g2GYwmUxgMzmC2Wq3Wm10LiMAE4nAcrLZ7IF9i5LgDofc0gcnogaW9SJ1IogABy/ahJAGpYHUDJg7JoXLXRpsxHVXiiCBYLjZKSE4bwmFkADyGu4EMx82x42sk2msyxixWaw24l4AF5NDI5AolMo9ezSCiwGiMTrFjirXiCXbiY7NGTtoYogEaYd6adzq53GCFb7lY9A45gqE+R9nsKEqL/ogUkCdDRQVXRFg5DhDBhnSGoDnWobjdkzUSw9b8bbzfaSRsAHR2R1wKSiB3rACSYCwzDlAB9eAAdcA8GA73ibgDKaFIImsI04VUE5gAqmATf3hgvh3ozzZNOJkABdHRQCBsAgVYvrw+TWIo+iamAtZTEByDICAsCMIIzDmAwVA/iA37flsFJRAAzIKFh0sciAAGzpiyVbTusCAWFy0SFu8DzciKmCVtWHJ1h4jbNmQmDtlGXZVEaUFwE+oaWkOkajtGpITuYlqzqqg54suq4brwR44GwnA3qpbiHlpp7npe153g+PASaMUkRrwb7np+mFUP+gF4AZMCgTA4HbFBMHWHBCFIShaE6Jh2G4TsURkURtJHAyjHUBcmZVopNh0Zy+bkUxxYsQ4bFilWgJcdKVbgjkWSwFIDk2Do8ZGMYXyJSmpE0syKWvNAuD0VllI5fynxln8yTFZK3EyhCcpQs0fpwkq3b+qiZ7BlGHkyUSL5xnhJgBC8LUMgETLJR400Igteb+H1rxFgNURxOW7EjRKtalSAvHqvxba8MJyJLei1lrSOG3jpoE6VTASwQEUaD8OYc7g9VJk2DM6pibUXWQ0Ugh6KJJriR2gMdptzpuvZSPWH+AFASAKJTfNNBQLkXW8CI31LAAsiMZPvhTkUJiYxjJiRB1fJRHXg5jMPmBdSBXbyt0mCcBUcaNL31m9TYfa2zo1F1uPZEe56WC+1mbVO45SC+ABK3kQXyUEAIJgBgRknjzZlkDe96PkT44zDV1hbVFJjRBRcWpogiXtR4NHdZl/gBKL13MQK+UPYVnFja970tgJvBpdYUg7gAVoIRDY3knAajudXbcYgr4cR8UFklGYeAXMuMv1JasThnWwHgAD0g+8DUABSR5bmA2MYOwvAsOwUECMIYjOsAU+8Ezk28MA8oFDcM3KrwsSurwggAO7CHKnD8Fg3RoKIADkcBQgA1pwj/iFPG9b5C9NkKfC+V894NB+qQUQ68+Cb14LHZSyBH5ECvPAJQABaKABhX6Pxwj/TeBc4GP1LuXOAlcNRYIoD/WIX8wA/3KnKcGp9Tr6lIGDDGUMpZP1oWfU+ARH4zEgdAmBFteAIKQXAVB6DSCYPIVA3BlopAELLhXM8pCKFUNiDodY+gkCgAyFYOAJo8BoAQLEWIQA=="}
// CJS
async function main() {
  const { createHighlighter } = await import('shiki')

  const highlighter = await createHighlighter({
    themes: ['vitesse-dark'],
    langs: ['javascript'],
  })

  const code = highlighter.codeToHtml('const a = 1', {
    theme: 'vitesse-dark',
    lang: 'javascript'
  })
}
```

### 使用 CDN

要在浏览器中通过 CDN 来使用 `shiki`，你可以使用 [esm.run](https://esm.run) 或者 [esm.sh](https://esm.sh) 等服务。

```html theme:rose-pine
<body>
  <div id="foo"></div>

  <script type="module">
    // 指定确切的版本号
    import { codeToHtml } from 'https://esm.sh/shiki@3.0.0'
    // 或
    // import { codeToHtml } from 'https://esm.run/shiki@3.0.0'

    const foo = document.getElementById('foo')
    foo.innerHTML = await codeToHtml('console.log("Hi, Shiki on CDN :)")', {
      lang: 'js',
      theme: 'rose-pine'
    })
  </script>
</body>
```

这非常高效，因为它只会按需加载语言和主题。对于上面的代码片段，只会发出四个请求 (`shiki`、`@shikijs/themes/vitesse-light`、`@shikijs/langs/javascript` 和 `shiki/wasm.mjs`)，共计传输约 200KB 的数据。

[查看示例](https://jsfiddle.net/t7brz23v/)

### Cloudflare Workers

Cloudflare Workers [不支持从二进制数据初始化 WebAssembly](https://community.cloudflare.com/t/fixed-cloudflare-workers-slow-with-moderate-sized-webassembly-bindings/184668/3)，因此默认的 WASM 构建将无法工作。你需要将 WASM 作为资产上传并直接导入。

同时，建议使用[细粒度捆绑](#细粒度捆绑)来减小捆绑的体积。

```ts twoslash theme:nord
// @twoslash-cache: {"v":1,"hash":"bfe5872ac6921f803b571ba86b1e03cfb73567b00d834a8de253d59ebf892256","data":"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"}
// @noErrors
import js from '@shikijs/langs/javascript'
import nord from '@shikijs/themes/nord'
import { createHighlighterCore, loadWasm } from 'shiki/core'

// 将 WASM 作为资产导入
await loadWasm(import('shiki/onig.wasm'))

export default {
  async fetch() {
    const highlighter = await createHighlighterCore({
      themes: [nord],
      langs: [js],
    })

    return new Response(highlighter.codeToHtml('console.log(\'shiki\');', {
      theme: 'nord',
      lang: 'js'
    }))
  },
}
```
